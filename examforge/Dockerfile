# ---------------------------
# 1️⃣ Base Image
# ---------------------------
FROM node:lts-slim

# ---------------------------
# 2️⃣ 작업 디렉터리 설정
# ---------------------------
WORKDIR /app

# ---------------------------
# 3️⃣ 의존성 파일 복사 및 설치
# ---------------------------
COPY package*.json ./
RUN npm install --production

# ---------------------------
# 4️⃣ 애플리케이션 코드 복사
# ---------------------------
COPY . .

# ---------------------------
# 5️⃣ 실행 권한 부여 (Apache 시작 스크립트)
# ---------------------------
RUN chmod +x /app/run_apache.sh

# ---------------------------
# 6️⃣ 환경 변수 및 포트 설정
# ---------------------------
ENV PORT=3000
EXPOSE 3000

# ---------------------------
# 7️⃣ 컨테이너 시작 시 실행될 명령어
# ---------------------------
CMD ["/bin/bash", "/app/run_apache.sh"]
